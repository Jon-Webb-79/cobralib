<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Database Management System &mdash; cobralib 0.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->

        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b1f64a84"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Input / Output (io)" href="io.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="index.html" class="icon icon-home">
            cobralib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="io.html">io</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">db</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#relational-database">relational_database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cobralib.db.relational_database"><code class="docutils literal notranslate"><span class="pre">relational_database()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#close-connection">close_connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#change-database">change_database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-databases">get_databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-database-tables">get_database_tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-table-columns">get_table_columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execute-query">execute_query</a></li>
<li class="toctree-l3"><a class="reference internal" href="#csv-to-table">csv_to_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="#excel-to-table">excel_to_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pdf-to-table">pdf_to_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cursor-and-connect">cursor and connect</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#protocol-class">Protocol Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cobralib.db.RelationalDB"><code class="docutils literal notranslate"><span class="pre">RelationalDB</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.change_database"><code class="docutils literal notranslate"><span class="pre">RelationalDB.change_database()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.close_connection"><code class="docutils literal notranslate"><span class="pre">RelationalDB.close_connection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.csv_to_table"><code class="docutils literal notranslate"><span class="pre">RelationalDB.csv_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.db_engine"><code class="docutils literal notranslate"><span class="pre">RelationalDB.db_engine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.excel_to_table"><code class="docutils literal notranslate"><span class="pre">RelationalDB.excel_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.execute_query"><code class="docutils literal notranslate"><span class="pre">RelationalDB.execute_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.get_database_tables"><code class="docutils literal notranslate"><span class="pre">RelationalDB.get_database_tables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.get_databases"><code class="docutils literal notranslate"><span class="pre">RelationalDB.get_databases()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.get_table_columns"><code class="docutils literal notranslate"><span class="pre">RelationalDB.get_table_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.pdf_to_table"><code class="docutils literal notranslate"><span class="pre">RelationalDB.pdf_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.conn"><code class="docutils literal notranslate"><span class="pre">RelationalDB.conn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.cur"><code class="docutils literal notranslate"><span class="pre">RelationalDB.cur</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.RelationalDB.database"><code class="docutils literal notranslate"><span class="pre">RelationalDB.database</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sql-classes">SQL Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cobralib.db.MySQLDB"><code class="docutils literal notranslate"><span class="pre">MySQLDB</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.change_database"><code class="docutils literal notranslate"><span class="pre">MySQLDB.change_database()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.close_connection"><code class="docutils literal notranslate"><span class="pre">MySQLDB.close_connection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.csv_to_table"><code class="docutils literal notranslate"><span class="pre">MySQLDB.csv_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.excel_to_table"><code class="docutils literal notranslate"><span class="pre">MySQLDB.excel_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.execute_query"><code class="docutils literal notranslate"><span class="pre">MySQLDB.execute_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.get_database_tables"><code class="docutils literal notranslate"><span class="pre">MySQLDB.get_database_tables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.get_databases"><code class="docutils literal notranslate"><span class="pre">MySQLDB.get_databases()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.get_table_columns"><code class="docutils literal notranslate"><span class="pre">MySQLDB.get_table_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.pdf_to_table"><code class="docutils literal notranslate"><span class="pre">MySQLDB.pdf_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.conn"><code class="docutils literal notranslate"><span class="pre">MySQLDB.conn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.cur"><code class="docutils literal notranslate"><span class="pre">MySQLDB.cur</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.database"><code class="docutils literal notranslate"><span class="pre">MySQLDB.database</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.MySQLDB.db_engine"><code class="docutils literal notranslate"><span class="pre">MySQLDB.db_engine</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cobralib.db.PostGreSQLDB"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.change_database"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.change_database()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.close_connection"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.close_connection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.csv_to_table"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.csv_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.excel_to_table"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.excel_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.execute_query"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.execute_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.get_database_tables"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.get_database_tables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.get_databases"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.get_databases()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.get_table_columns"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.get_table_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.pdf_to_table"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.pdf_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.conn"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.conn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.cur"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.cur</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.database"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.database</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.PostGreSQLDB.db_engine"><code class="docutils literal notranslate"><span class="pre">PostGreSQLDB.db_engine</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cobralib.db.SQLiteDB"><code class="docutils literal notranslate"><span class="pre">SQLiteDB</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.change_database"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.change_database()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.close_connection"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.close_connection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.csv_to_table"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.csv_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.excel_to_table"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.excel_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.execute_query"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.execute_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.get_database_tables"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.get_database_tables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.get_databases"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.get_databases()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.get_table_columns"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.get_table_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.pdf_to_table"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.pdf_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.conn"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.conn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.cur"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.cur</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.database"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.database</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLiteDB.db_engine"><code class="docutils literal notranslate"><span class="pre">SQLiteDB.db_engine</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cobralib.db.SQLServerDB"><code class="docutils literal notranslate"><span class="pre">SQLServerDB</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.change_database"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.change_database()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.close_connection"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.close_connection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.csv_to_table"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.csv_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.excel_to_table"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.excel_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.execute_query"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.execute_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.get_database_tables"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.get_database_tables()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.get_databases"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.get_databases()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.get_table_columns"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.get_table_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.pdf_to_table"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.pdf_to_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.conn"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.conn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.cur"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.cur</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.database"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.database</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#cobralib.db.SQLServerDB.db_engine"><code class="docutils literal notranslate"><span class="pre">SQLServerDB.db_engine</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cobralib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Database Management System</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/db.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="database-management-system">
<h1>Database Management System<a class="headerlink" href="#database-management-system" title="Permalink to this heading"></a></h1>
<p>The io module was written to contain functions and classes that can simplify and
standardize the way a user interacts with Relational Database Management Systems(RDBMS).
This module contains classes that a user can use and expand upong to interact
with Microsoft SQL-Server, MySQL, PostGreSQL, and SQLite.  In addition,
that class contains a comman interface for all four RDBM systems.  <strong>NOTE:</strong> Future
versions of this library may also contain interfaces for OracleDB.</p>
<section id="relational-database">
<span id="rel-db"></span><h2>relational_database<a class="headerlink" href="#relational-database" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">relational_database</span></code> function provides a common interface to the Microsfot SQL-Server,
MySQL, PostGreSQL, and SQLite Relational Database Management Systems.  This function
returns an object of <code class="docutils literal notranslate"><span class="pre">MySQLDB</span></code>, <code class="docutils literal notranslate"><span class="pre">PostGreSQLDB</span></code>, <code class="docutils literal notranslate"><span class="pre">MSSQL</span></code>, or <code class="docutils literal notranslate"><span class="pre">SQLiteDB</span></code> which is described
in the <a class="reference internal" href="#sql-overview"><span class="std std-ref">SQL Classes</span></a> Section of this documnet.  The form of these classes
must conform to the interfaces of the Protocol class titled <a class="reference internal" href="#protocol-overview"><span class="std std-ref">RelationalDatabase</span></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="cobralib.db.relational_database">
<span class="sig-prename descclassname"><span class="pre">cobralib.db.</span></span><span class="sig-name descname"><span class="pre">relational_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cert</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'yes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'{ODBC</span> <span class="pre">Driver</span> <span class="pre">18</span> <span class="pre">for</span> <span class="pre">SQL</span> <span class="pre">Server}'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#cobralib.db.RelationalDB" title="cobralib.db.RelationalDB"><span class="pre">RelationalDB</span></a></span></span><a class="reference internal" href="_modules/cobralib/db.html#relational_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.relational_database" title="Permalink to this definition"></a></dt>
<dd><p>Method will return a relational database object of type RelationalDB</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_type</strong> – A string representing the database management system, can be
MySQL, MSSQL, PostGres or SQLite. This parameter is case
insensitive. Case Insensitive</p></li>
<li><p><strong>database</strong> – The database you wish to connect to, defaulted to appropriate
port number for each database manager</p></li>
<li><p><strong>username</strong> – The username for the database connection.</p></li>
<li><p><strong>password</strong> – The password for the database connection.</p></li>
<li><p><strong>port</strong> – The port number for the database connection. Defaulted to 3306</p></li>
<li><p><strong>hostname</strong> – The hostname for the database connection
(default is ‘localhost’).</p></li>
<li><p><strong>cert</strong> – yes to trust certificat and no to not trust certificate
without authentication. Defaulted to yes</p></li>
<li><p><strong>driver</strong> – The ODBC driver to use for connection. Defaulted to
“{ODBC Driver 18 for SQL Server}”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">RelationalDB</span></code> object returned by this <code class="docutils literal notranslate"><span class="pre">relational_database</span></code> function is described in
the <a class="reference internal" href="#protocol-overview"><span class="std std-ref">RelationalDatabase</span></a> Section. The following are examples for how
these methods can be used.</p>
<section id="close-connection">
<h3>close_connection<a class="headerlink" href="#close-connection" title="Permalink to this heading"></a></h3>
<p>The close connection methods closes the database and the the server connection.  This method
is further demonstrated in each example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Code example for connection to a NySQL server instance</span>
<span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;MYSQL&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;usernaame&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span>
                         <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;database_name&#39;</span><span class="p">)</span>

<span class="c1"># close connection</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Code example for connection to a SQLite instance</span>
<span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection (SQLite only needs the database_file name to be passed in the constructor</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;SQLITE&quot;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;database_name&#39;</span><span class="p">)</span>

<span class="c1"># close connection</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="change-database">
<h3>change_database<a class="headerlink" href="#change-database" title="Permalink to this heading"></a></h3>
<p>This method allows a user to change from one database to another</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Code example with PostGreSQL</span>
<span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;POSTGRES&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;usernaame&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span>
                         <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>

<span class="n">db</span><span class="o">.</span><span class="n">change_database</span><span class="p">(</span><span class="s1">&#39;second_db&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>

<span class="c1"># close connection</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<p>This produces the following output, and changes the cursor to interact with the new database</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>first_db
second_db
</pre></div>
</div>
</section>
<section id="get-databases">
<h3>get_databases<a class="headerlink" href="#get-databases" title="Permalink to this heading"></a></h3>
<p>This method allows a user to return a pandas dataframe containing a list of all databases
in the server.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Code example with PostGreSQL</span>
<span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;POSTGRES&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;usernaame&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span>
                         <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_databases</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<p>This method will return a value similar to the one shown below where db_one, db_two, and db_three
represent databases within the server</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">    </span>Databases
<span class="m">0</span><span class="w">   </span>db_one
<span class="m">1</span><span class="w">   </span>db_two
<span class="m">2</span><span class="w">   </span>db_two
</pre></div>
</div>
<p>SQLite does not contain true databases, and instead employes database files, typically ending
with a .db.  Implementing this function with SQLite will give the following results.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection (SQLite only needs the database_file name to be passed in the constructor</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;SQLITE&quot;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;database_name&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_databases</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1"># close connection</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SQLite<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>support<span class="w"> </span>databases,<span class="w"> </span>returning<span class="w"> </span>an<span class="w"> </span>empty<span class="w"> </span>dataframe

<span class="w">    </span>Databases
</pre></div>
</div>
</section>
<section id="get-database-tables">
<h3>get_database_tables<a class="headerlink" href="#get-database-tables" title="Permalink to this heading"></a></h3>
<p>This method allows a user to return a pandas dataframe containing all of the tables
in the current, or a user selected database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;MYSQL&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;usernaame&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span>
                         <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_database_tables</span><span class="p">()</span>

<span class="c1"># - While in first_db, we can access second_db tables, assuming your password</span>
<span class="c1">#   and username have access to the second database</span>
<span class="n">new_df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_database_tables</span><span class="p">(</span><span class="s1">&#39;second_db&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>

<span class="c1"># While in db_one</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">    </span>Tables
<span class="m">0</span><span class="w">   </span>first_db_table_one
<span class="m">1</span><span class="w">   </span>first_db_table_two
<span class="m">2</span><span class="w">   </span>first_db_table_two

<span class="w">    </span>Tables
<span class="m">0</span><span class="w">   </span>second_db_table_one
<span class="m">1</span><span class="w">   </span>second_db_table_two
<span class="m">2</span><span class="w">   </span>second_db_table_three
</pre></div>
</div>
</section>
<section id="get-table-columns">
<h3>get_table_columns<a class="headerlink" href="#get-table-columns" title="Permalink to this heading"></a></h3>
<p>This method will return a list of table column names and their attributes.  The user
can select from a table within their current database or a database that they
are not currently in, assuming they have password permission to use the other database,
with the expception of SQLite which does not require a password.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;MYSQL&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;usernaame&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span>
                         <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_columns</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">      </span>Field<span class="w">      </span>Type<span class="w">        </span>Null<span class="w">   </span>Key<span class="w">     </span>Default<span class="w">  </span>Extra
<span class="m">0</span><span class="w">     </span>name_id<span class="w">    </span>Integer<span class="w">     </span>True<span class="w">   </span>Primary<span class="w">  </span>False<span class="w">   </span>auto_increment
<span class="m">1</span><span class="w">     </span>FirstName<span class="w">  </span>Varchar<span class="o">(</span><span class="m">20</span><span class="o">)</span><span class="w"> </span>False<span class="w">  </span>NA<span class="w">       </span>False<span class="w">   </span>None
<span class="m">2</span><span class="w">     </span>MiddleName<span class="w"> </span>Varchar<span class="o">(</span><span class="m">20</span><span class="o">)</span><span class="w"> </span>True<span class="w">   </span>NA<span class="w">       </span>False<span class="w">   </span>None
<span class="m">3</span><span class="w">     </span>LastName<span class="w">   </span>Varchar<span class="o">(</span><span class="m">20</span><span class="o">)</span><span class="w"> </span>False<span class="w">  </span>NA<span class="w">       </span>False<span class="w">   </span>None
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;MYSQL&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;usernaame&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span>
                         <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db&#39;</span><span class="p">)</span>

<span class="c1"># Get table attributes from a table in another database</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_columns</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">,</span> <span class="s1">&#39;second_db&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">      </span>Field<span class="w">      </span>Type<span class="w">        </span>Null<span class="w">   </span>Key<span class="w">     </span>Default<span class="w">  </span>Extra
<span class="m">0</span><span class="w">     </span>name_id<span class="w">    </span>Integer<span class="w">     </span>True<span class="w">   </span>Primary<span class="w">  </span>False<span class="w">   </span>auto_increment
<span class="m">1</span><span class="w">     </span>FirstName<span class="w">  </span>Varchar<span class="o">(</span><span class="m">20</span><span class="o">)</span><span class="w"> </span>False<span class="w">  </span>NA<span class="w">       </span>False<span class="w">   </span>None
<span class="m">2</span><span class="w">     </span>MiddleName<span class="w"> </span>Varchar<span class="o">(</span><span class="m">20</span><span class="o">)</span><span class="w"> </span>True<span class="w">   </span>NA<span class="w">       </span>False<span class="w">   </span>None
<span class="m">3</span><span class="w">     </span>LastName<span class="w">   </span>Varchar<span class="o">(</span><span class="m">20</span><span class="o">)</span><span class="w"> </span>False<span class="w">  </span>NA<span class="w">       </span>False<span class="w">   </span>None
</pre></div>
</div>
</section>
<section id="execute-query">
<h3>execute_query<a class="headerlink" href="#execute-query" title="Permalink to this heading"></a></h3>
<p>This method allows a user to execute a databse query that can interact with the database and return
no information, or it can also return information in a pandas dataframe.  Furthermore for SQL injection
attack protectionl this method allows a user to parameterize their query and pass parameters as
a seperate attribute in the method. <strong>NOTE:</strong>, Usually when using <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> to manage a SQLite
interface, parameters are passed as a <code class="docutils literal notranslate"><span class="pre">?</span></code>; however, in an effort to standardize the interface
params are passed as <code class="docutils literal notranslate"><span class="pre">%s</span></code> to mirror the behavior of <code class="docutils literal notranslate"><span class="pre">mysql-connector-python</span></code> and <code class="docutils literal notranslate"><span class="pre">postgresql</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;SQLITE&quot;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS Names (</span>
<span class="s2">    name_id INTEGER PRIMARY KEY AUTOINCREMENT,</span>
<span class="s2">    FirstName VARCHAR(20) NOT NULL,</span>
<span class="s2">    MiddleName VARCHAR(20),</span>
<span class="s2">    LastName VARCHAR(20) NOT NULL</span>
<span class="s2"> );</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO TABLE Names (FirstName, LastName) VALUES(&#39;Jon&#39;, &#39;Webb&#39;;&quot;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO TABLE Names (FirstName, LastName) VALUES(&#39;Jillian&#39;, &#39;Webb&#39;;&quot;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO TABLE Names (FirstName, MiddleName, LastName) VALUES(&#39;Chris&#39;, &#39;Tate&#39;, &#39;Smith&#39;;&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Names;&quot;</span><span class="p">)</span>
<span class="n">new_df</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Names WHERE LastName = </span><span class="si">%s</span><span class="s2">;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Webb&#39;</span><span class="p">,</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">      </span>name_id<span class="w">  </span>FirstName<span class="w">  </span>MiddleName<span class="w">  </span>LastNam
<span class="m">0</span><span class="w">     </span><span class="m">1</span><span class="w">        </span>Jon<span class="w">                    </span>Webb
<span class="m">1</span><span class="w">     </span><span class="m">2</span><span class="w">        </span>Jillian<span class="w">                </span>Webb
<span class="m">2</span><span class="w">     </span><span class="m">3</span><span class="w">        </span>Chris<span class="w">      </span>Tate<span class="w">        </span>Smith

<span class="w">      </span>name_id<span class="w">  </span>FirstName<span class="w">  </span>MiddleName<span class="w">  </span>LastNam
<span class="m">0</span><span class="w">     </span><span class="m">1</span><span class="w">        </span>Jon<span class="w">                    </span>Webb
<span class="m">1</span><span class="w">     </span><span class="m">2</span><span class="w">         </span>Jillian<span class="w">                </span>Webb
</pre></div>
</div>
</section>
<section id="csv-to-table">
<h3>csv_to_table<a class="headerlink" href="#csv-to-table" title="Permalink to this heading"></a></h3>
<p>This method allows a user to read in specific columns from a csv table, and map them
to the column names of a SQL table.  For example assume we have a csv file with the following
format. <strong>NOTE:</strong> The following method also has a skip attribute that can be used to skip
rows in a csv or other ASCII based text file before reading in a header.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Product,Inventory
Apple,5
Banana,12
Cucumber,20
Peach,3
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;SQLITE&quot;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS Inventory (</span>
<span class="s2">    inv_id INTEGER PRIMARY KEY AUTOINCREMENT,</span>
<span class="s2">    Prd VARCHAR(20) NOT NULL,</span>
<span class="s2">    Inv INTEGER</span>
<span class="s2"> );</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">csv_file</span> <span class="o">=</span> <span class="s2">&quot;inventory.csv&quot;</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;inventory&#39;</span>
<span class="n">dat_type</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Product&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Inventory&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">}</span>
<span class="c1"># Table cols are optional if csv file and table have same header names</span>
<span class="n">table_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Prd&quot;</span><span class="p">,</span> <span class="s2">&quot;Inv&quot;</span><span class="p">]</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">dat_type</span><span class="p">,</span> <span class="n">table_cols</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Inventory;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">      </span>inv_id<span class="w">   </span>Prd<span class="w">      </span>Inv
<span class="m">0</span><span class="w">     </span><span class="m">1</span><span class="w">        </span>Apple<span class="w">    </span><span class="m">5</span>
<span class="m">1</span><span class="w">     </span><span class="m">2</span><span class="w">        </span>Banana<span class="w">   </span><span class="m">12</span>
<span class="m">2</span><span class="w">     </span><span class="m">3</span><span class="w">        </span>Cucumber<span class="w"> </span><span class="m">20</span>
<span class="m">3</span><span class="w">     </span><span class="m">4</span><span class="w">        </span>Peach<span class="w">    </span><span class="m">3</span>
</pre></div>
</div>
<p>This method can also be used to read data in from space delimited files</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Product<span class="w">   </span>Inventory
Apple<span class="w">     </span><span class="m">5</span>
Banana<span class="w">    </span><span class="m">12</span>
Cucumber<span class="w">  </span><span class="m">20</span>
Peach<span class="w">     </span><span class="m">3</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;SQLITE&quot;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS Inventory (</span>
<span class="s2">    inv_id INTEGER PRIMARY KEY AUTOINCREMENT,</span>
<span class="s2">    Prd VARCHAR(20) NOT NULL,</span>
<span class="s2">    Inv INTEGER</span>
<span class="s2"> );</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">csv_file</span> <span class="o">=</span> <span class="s2">&quot;inventory.txt&quot;</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;inventory&#39;</span>
<span class="n">dat_type</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Product&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Inventory&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">}</span>
<span class="c1"># Table cols are optional if csv file and table have same header names</span>
<span class="n">table_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Prd&quot;</span><span class="p">,</span> <span class="s2">&quot;Inv&quot;</span><span class="p">]</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">dat_type</span><span class="p">,</span> <span class="n">table_cols</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Inventory;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">      </span>inv_id<span class="w">   </span>Prd<span class="w">      </span>Inv
<span class="m">0</span><span class="w">     </span><span class="m">1</span><span class="w">        </span>Apple<span class="w">    </span><span class="m">5</span>
<span class="m">1</span><span class="w">     </span><span class="m">2</span><span class="w">        </span>Banana<span class="w">   </span><span class="m">12</span>
<span class="m">2</span><span class="w">     </span><span class="m">3</span><span class="w">        </span>Cucumber<span class="w"> </span><span class="m">20</span>
<span class="m">3</span><span class="w">     </span><span class="m">4</span><span class="w">        </span>Peach<span class="w">    </span><span class="m">3</span>
</pre></div>
</div>
</section>
<section id="excel-to-table">
<h3>excel_to_table<a class="headerlink" href="#excel-to-table" title="Permalink to this heading"></a></h3>
<p>This method can be used to read in specific columns from an excel file
and feed them into an existing sql table.  Assume we have the following
excel table stored in the sheet name titled test.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Product<span class="w">   </span>Inventory
Apple<span class="w">     </span><span class="m">5</span>
Banana<span class="w">    </span><span class="m">12</span>
Cucumber<span class="w">  </span><span class="m">20</span>
Peach<span class="w">     </span><span class="m">3</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;SQLITE&quot;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS Inventory (</span>
<span class="s2">    inv_id INTEGER PRIMARY KEY AUTOINCREMENT,</span>
<span class="s2">    Prd VARCHAR(20) NOT NULL,</span>
<span class="s2">    Inv INTEGER</span>
<span class="s2"> );</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">excel_file</span> <span class="o">=</span> <span class="s2">&quot;inventory.xlsx&quot;</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;inventory&#39;</span>
<span class="n">dat_type</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Product&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Inventory&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">}</span>
<span class="c1"># Table cols are optional if csv file and table have same header names</span>
<span class="n">table_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Prd&quot;</span><span class="p">,</span> <span class="s2">&quot;Inv&quot;</span><span class="p">]</span>
<span class="n">db</span><span class="o">.</span><span class="n">excel_to_table</span><span class="p">(</span><span class="n">excel_file</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">dat_type</span><span class="p">,</span> <span class="n">table_cols</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Inventory;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">      </span>inv_id<span class="w">   </span>Prd<span class="w">      </span>Inv
<span class="m">0</span><span class="w">     </span><span class="m">1</span><span class="w">        </span>Apple<span class="w">    </span><span class="m">5</span>
<span class="m">1</span><span class="w">     </span><span class="m">2</span><span class="w">        </span>Banana<span class="w">   </span><span class="m">12</span>
<span class="m">2</span><span class="w">     </span><span class="m">3</span><span class="w">        </span>Cucumber<span class="w"> </span><span class="m">20</span>
<span class="m">3</span><span class="w">     </span><span class="m">4</span><span class="w">        </span>Peach<span class="w">    </span><span class="m">3</span>
</pre></div>
</div>
</section>
<section id="pdf-to-table">
<h3>pdf_to_table<a class="headerlink" href="#pdf-to-table" title="Permalink to this heading"></a></h3>
<p>While excel files and csv files are some of the most common data storage methods, data can also
be found within vectorized pdf files.  This method allows a user to extract data from
vectorized pdf files, and can read data in from tables that span multiple pages.  Imagine
a pdf table has the following structure.  The pdf table exists as the 3rd table on page 2
of the document.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Product<span class="w">   </span>Inventory
Apple<span class="w">     </span><span class="m">5</span>
Banana<span class="w">    </span><span class="m">12</span>
Cucumber<span class="w">  </span><span class="m">20</span>
Peach<span class="w">     </span><span class="m">3</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;SQLITE&quot;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS Inventory (</span>
<span class="s2">    inv_id INTEGER PRIMARY KEY AUTOINCREMENT,</span>
<span class="s2">    Prd VARCHAR(20) NOT NULL,</span>
<span class="s2">    Inv INTEGER</span>
<span class="s2"> );</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">excel_file</span> <span class="o">=</span> <span class="s2">&quot;inventory.xlsx&quot;</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;inventory&#39;</span>
<span class="n">dat_type</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Product&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Inventory&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">}</span>
<span class="c1"># Table cols are optional if csv file and table have same header names</span>
<span class="n">table_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Prd&quot;</span><span class="p">,</span> <span class="s2">&quot;Inv&quot;</span><span class="p">]</span>
<span class="n">db</span><span class="o">.</span><span class="n">excel_to_table</span><span class="p">(</span><span class="n">excel_file</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">dat_type</span><span class="p">,</span> <span class="n">table_cols</span><span class="p">,</span> <span class="n">table_idx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">page_num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Inventory;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">      </span>inv_id<span class="w">   </span>Prd<span class="w">      </span>Inv
<span class="m">0</span><span class="w">     </span><span class="m">1</span><span class="w">        </span>Apple<span class="w">    </span><span class="m">5</span>
<span class="m">1</span><span class="w">     </span><span class="m">2</span><span class="w">        </span>Banana<span class="w">   </span><span class="m">12</span>
<span class="m">2</span><span class="w">     </span><span class="m">3</span><span class="w">        </span>Cucumber<span class="w"> </span><span class="m">20</span>
<span class="m">3</span><span class="w">     </span><span class="m">4</span><span class="w">        </span>Peach<span class="w">    </span><span class="m">3</span>
</pre></div>
</div>
</section>
<section id="cursor-and-connect">
<h3>cursor and connect<a class="headerlink" href="#cursor-and-connect" title="Permalink to this heading"></a></h3>
<p>The user also has access to the cursor (self.cur) and the connect (self.conn) attributes within
the object returned from the relational_database function.  They are able to access
this attribute and use it in whatever way they want; however, make sure to consult
the correct docucmentation depending on which database type you use.  The
MySQL type uses the mysql-connector-python package, the SQLite type uses the sqlite3
package, and PostGreSQL uses the pygresql package.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.db</span> <span class="kn">import</span> <span class="n">relational_database</span>

<span class="c1"># open connection, user must pass a database name</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">relational_database</span><span class="p">(</span><span class="n">db_type</span><span class="o">=</span><span class="s2">&quot;SQLITE&quot;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;first_db.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS Inventory (</span>
<span class="s2">    inv_id INTEGER PRIMARY KEY AUTOINCREMENT,</span>
<span class="s2">    Prd VARCHAR(20) NOT NULL,</span>
<span class="s2">    Inv INTEGER</span>
<span class="s2"> );</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">db</span><span class="o">.</span><span class="n">cur</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="protocol-class">
<span id="protocol-overview"></span><h2>Protocol Class<a class="headerlink" href="#protocol-class" title="Permalink to this heading"></a></h2>
<p>The <a class="reference internal" href="#rel-db"><span class="std std-ref">relational_database</span></a> function implements a Factory Pattern to create an object of type <code class="docutils literal notranslate"><span class="pre">RelationalDB</span></code>.
Any class that is implemented in the factory pattern must constrain to the interface described in the <code class="docutils literal notranslate"><span class="pre">RelationalDB</span></code> Protocol
class below.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cobralib.db.</span></span><span class="sig-name descname"><span class="pre">RelationalDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB" title="Permalink to this definition"></a></dt>
<dd><p>A protocol class to handle structural sub-typing of classes used to read and
interact with relational databases</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> – The name of the database currently being used</p></li>
<li><p><strong>conn</strong> – The connection attribute of the database management system</p></li>
<li><p><strong>cur</strong> – The cursor attribute of the database management system.</p></li>
<li><p><strong>db_engine</strong> – A string representing the type of database engine</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – If a connection can not be established</p>
</dd>
</dl>
<p>More to be added later</p>
<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.change_database">
<span class="sig-name descname"><span class="pre">change_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.change_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.change_database" title="Permalink to this definition"></a></dt>
<dd><p>Method to change the connection from one database to another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – The new database or database file to be used.  If a database
file, this must include the path length.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – if query fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.close_connection">
<span class="sig-name descname"><span class="pre">close_connection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.close_connection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.close_connection" title="Permalink to this definition"></a></dt>
<dd><p>Close the connection to the database managment system</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ConnectionError</strong> – If the connection does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.csv_to_table">
<span class="sig-name descname"><span class="pre">csv_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.csv_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.csv_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from a CSV or TXT file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csv_file</strong> – The path to the CSV file or TXT file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>csv_headers</strong> – The names of the columns in the TXT file and datatypes
as a dictionary.</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes CSV column names and table column names
are the same).</p></li>
<li><p><strong>delimiter</strong> – The seperating delimeter in the text file.  Defaulted to
‘,’ for a CSV file, but can work with other delimeters</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition.  Defaulted to 0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the CSV file or table name is not provided, or if
the number of CSV columns and table columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.db_engine">
<span class="sig-name descname"><span class="pre">db_engine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.db_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.db_engine" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _db_engine attribute</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.excel_to_table">
<span class="sig-name descname"><span class="pre">excel_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excel_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excel_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Sheet1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.excel_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.excel_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from an Excel file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>excel_file</strong> – The path to the Excel file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>excel_headers</strong> – The names of the columns in the Excel file and their
data types as a dictionary.</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes Excel column names and table column names are
the same).</p></li>
<li><p><strong>sheet_name</strong> – The name of the sheet in the Excel file (default is ‘Sheet1’).</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition. Defaulted to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the Excel file, table name, or sheet name is not
provided, or if the number of Excel columns and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.execute_query">
<span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.execute_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.execute_query" title="Permalink to this definition"></a></dt>
<dd><p>Execute a query with placeholders and return the result as a Pandas DataFrame.
The user of this class should ensure that when applicable they parameteratize
the inputs to this method to minimize the potential for an injection
attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – The query with placeholders.</p></li>
<li><p><strong>params</strong> – The values to be substituted into the placeholders
(default is an empty tuple).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Pandas DataFrame with the query result.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If the database name is not provided.</p></li>
<li><p><strong>ConnectionError</strong> – If the query execution fails.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.get_database_tables">
<span class="sig-name descname"><span class="pre">get_database_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.get_database_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.get_database_tables" title="Permalink to this definition"></a></dt>
<dd><p>Method to retrieve a dataframe containing a list of all tables wtihin
the SQL database or database file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – The name of the database or database file that the tables
will be retrieved from.</p>
</dd>
<dt class="field-even">Return df<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe containing all information relating to the tables
within the database or database file.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ConnectionError</strong> – If program is not able to get tables</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.get_databases">
<span class="sig-name descname"><span class="pre">get_databases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.get_databases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.get_databases" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve the names of all databases available to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A pandas dataframe of database names with a header of Databases</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.get_table_columns">
<span class="sig-name descname"><span class="pre">get_table_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.get_table_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.get_table_columns" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve the names and data types of the columns within the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>database</strong> – The database name, defaulted to currently selected database
or None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Pandas Dataframe with the table information</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the database is not selected at the class level
:raises ConnectionError: If the columns cannot be retrieved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.pdf_to_table">
<span class="sig-name descname"><span class="pre">pdf_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#RelationalDB.pdf_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.RelationalDB.pdf_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read a table from a PDF file and insert it into the specified SQLite table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> – The path to the PDF file.</p></li>
<li><p><strong>table_name</strong> – The name of the SQLite table.</p></li>
<li><p><strong>pdf_headers</strong> – A dictionary of column names in the PDF and their data
types.</p></li>
<li><p><strong>table_columns</strong> – The names of the columns in the SQLite table
(default is None, assumes PDF column names and SQLite
column names are the same).</p></li>
<li><p><strong>table_idx</strong> – Index of the table in the PDF (default: 0).</p></li>
<li><p><strong>page_num</strong> – Page number from which to extract the table (default: 0).</p></li>
<li><p><strong>skip</strong> – The number of rows to skip in the PDF table.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the PDF file, table name, or sheet name is not
provided, or if the number of PDF headers and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.conn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.RelationalDB.conn" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _conn attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.cur">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cur</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.RelationalDB.cur" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _cur attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.RelationalDB.database">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">database</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.RelationalDB.database" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _database attribute</p>
</dd></dl>

</dd></dl>

</section>
<section id="sql-classes">
<span id="sql-overview"></span><h2>SQL Classes<a class="headerlink" href="#sql-classes" title="Permalink to this heading"></a></h2>
<p>The classes described in this section are used in the Factory Patter which build the <a class="reference internal" href="#rel-db"><span class="std std-ref">relational_database</span></a> function.
However, a user can also import and access these classes if they wish to inherit them and build upon their capability.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cobralib.db.</span></span><span class="sig-name descname"><span class="pre">MySQLDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3306</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'localhost'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB" title="Permalink to this definition"></a></dt>
<dd><p>A class for connecting to MySQL databases using mysql-connector-python.
The user can access the conn and cur variables, where conn is the
connection variable and cur is the connection.cursor() method to
expand the capability of this class beyond its methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> – The username for the database connection.</p></li>
<li><p><strong>password</strong> – The password for the database connection.</p></li>
<li><p><strong>port</strong> – The port number for the database connection. Defaulted to 3306</p></li>
<li><p><strong>hostname</strong> – The hostname for the database connection
(default is ‘localhost’).</p></li>
<li><p><strong>database</strong> – The database you wish to connect to, defaulted to None</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – If a connection can not be established</p>
</dd>
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conn</strong> – The connection attribute of the mysql-connector-python module.</p></li>
<li><p><strong>cur</strong> – The cursor method for the mysql-connector-python module.</p></li>
<li><p><strong>db_engine</strong> – A string describing the database engine</p></li>
<li><p><strong>database</strong> – The name of the database currently being used.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.change_database">
<span class="sig-name descname"><span class="pre">change_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.change_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.change_database" title="Permalink to this definition"></a></dt>
<dd><p>Change to the specified database within the server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – The name of the database to change to.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – if query fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.close_connection">
<span class="sig-name descname"><span class="pre">close_connection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.close_connection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.close_connection" title="Permalink to this definition"></a></dt>
<dd><p>Close the connection to the server.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ConnectionError</strong> – If the connection does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.csv_to_table">
<span class="sig-name descname"><span class="pre">csv_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.csv_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.csv_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from a CSV or TXT file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csv_file</strong> – The path to the CSV file or TXT file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>csv_headers</strong> – The names of the columns in the TXT file and datatypes
as a dictionary.</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes CSV column names and table column names
are the same).</p></li>
<li><p><strong>delimiter</strong> – The seperating delimeter in the text file.  Defaulted to
‘,’ for a CSV file, but can work with other delimeters</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition.  Defaulted to 0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the CSV file or table name is not provided, or if
the number of CSV columns and table columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
<p>Assune we have a csv table with the following Columns, <code class="docutils literal notranslate"><span class="pre">FirstName</span></code>,
<code class="docutils literal notranslate"><span class="pre">MiddleName</span></code>, <code class="docutils literal notranslate"><span class="pre">LastName</span></code>.  Within the <code class="docutils literal notranslate"><span class="pre">Names</span></code> database we have
a table with no entries that has columns for <code class="docutils literal notranslate"><span class="pre">First</span></code> and <code class="docutils literal notranslate"><span class="pre">Last</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">change_db</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;csv_file.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">])</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
<p>If instead of a csv file, you have a text file that uses spaces as
a delimeter, and the first two rows are consumed by file metadata
before reaching the header, the following code will work</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">change_db</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;txt_file.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">],</span> <span class="n">delemeter</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.excel_to_table">
<span class="sig-name descname"><span class="pre">excel_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excel_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excel_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Sheet1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.excel_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.excel_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from an Excel file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>excel_file</strong> – The path to the Excel file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>excel_headers</strong> – The names of the columns in the Excel file and their
data types as a dictionary</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes Excel column names and table column names are
the same).</p></li>
<li><p><strong>sheet_name</strong> – The name of the sheet in the Excel file
(default is ‘Sheet1’).</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition.  Defaulted to 0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the Excel file, table name, or sheet name is not
provided, or if the number of Excel columns and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
<p>Assune we have an excel table with the following Columns, <code class="docutils literal notranslate"><span class="pre">FirstName</span></code>,
<code class="docutils literal notranslate"><span class="pre">MiddleName</span></code>, <code class="docutils literal notranslate"><span class="pre">LastName</span></code>.  Within the <code class="docutils literal notranslate"><span class="pre">Names</span></code> database we have
a table with no entries that has columns for <code class="docutils literal notranslate"><span class="pre">First</span></code> and <code class="docutils literal notranslate"><span class="pre">Last</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">change_db</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;excel_file.xlsx&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">{</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">},</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">])</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.execute_query">
<span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.execute_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.execute_query" title="Permalink to this definition"></a></dt>
<dd><p>Execute a query with placeholders and return the result as a Pandas DataFrame.
The user of this class should ensure that when applicable they parameteratize
the inputs to this method to minimize the potential for an injection
attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – The query with placeholders.</p></li>
<li><p><strong>params</strong> – The values to be substituted into the placeholders
(default is an empty tuple).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Pandas DataFrame with the query result.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If the database name is not provided.</p></li>
<li><p><strong>ConnectionError</strong> – If the query execution fails.</p></li>
</ul>
</dd>
</dl>
<p>Example usage when parameters are provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM names WHERE name_id = </span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span>  <span class="n">FirstName</span>  <span class="n">LastName</span>
   <span class="mi">0</span>      <span class="mi">2</span>        <span class="n">Fred</span>       <span class="n">Smith</span>
</pre></div>
</div>
<p>Example usage when no parameters are provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM names&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span>  <span class="n">FirstName</span>  <span class="n">LastName</span>
 <span class="mi">0</span>        <span class="mi">1</span>        <span class="n">Jon</span>        <span class="n">Webb</span>
 <span class="mi">1</span>        <span class="mi">2</span>        <span class="n">Fred</span>       <span class="n">Smith</span>
 <span class="mi">2</span>        <span class="mi">3</span>        <span class="n">Jillian</span>    <span class="n">Webb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.get_database_tables">
<span class="sig-name descname"><span class="pre">get_database_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.get_database_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.get_database_tables" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve the names of all tables within the current database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – Database name, defaulted to currently selected database or None</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas dataframe of table names with a header of Tables</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If no database is currently selected.</p></li>
<li><p><strong>ConnectionError</strong> – If program is not able to get tables</p></li>
</ul>
</dd>
</dl>
<p>Assuming the user has a database titled <code class="docutils literal notranslate"><span class="pre">Inventory</span></code> which had the
tables <code class="docutils literal notranslate"><span class="pre">Names</span></code>, <code class="docutils literal notranslate"><span class="pre">Product</span></code>, <code class="docutils literal notranslate"><span class="pre">Sales</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">dbs</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_database_tables</span><span class="p">(</span><span class="s2">&quot;Inventory&quot;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dbs</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">Tables</span>
   <span class="mi">0</span>      <span class="n">Names</span>
   <span class="mi">1</span>      <span class="n">Product</span>
   <span class="mi">2</span>      <span class="n">Sales</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.get_databases">
<span class="sig-name descname"><span class="pre">get_databases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.get_databases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.get_databases" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve the names of all databases available to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A pandas dataframe of database names with a header of Databases</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – If program fails to retrive database</p>
</dd>
</dl>
<p>If you assume the server has three databases available to the username, and
those databases were <code class="docutils literal notranslate"><span class="pre">Inventory</span></code>, <code class="docutils literal notranslate"><span class="pre">Address</span></code>, <code class="docutils literal notranslate"><span class="pre">project_data</span></code>, you
could use this class with the following commands.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">dbs</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_databases</span><span class="p">()</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dbs</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">Databases</span>
   <span class="mi">0</span>      <span class="n">Address</span>
   <span class="mi">1</span>      <span class="n">Inventory</span>
   <span class="mi">2</span>      <span class="n">project_data</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.get_table_columns">
<span class="sig-name descname"><span class="pre">get_table_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.get_table_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.get_table_columns" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Retrieve the names and data types of the columns within the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">param table_name<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the table.</p>
</dd>
<dt class="field-even">param database<span class="colon">:</span></dt>
<dd class="field-even"><p>The database name, defaulted to currently selected database
or None</p>
</dd>
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>A pandas dataframe with headers ot Field, Type, Null, Key, Default,
and Extra</p>
</dd>
<dt class="field-even">raises ValueError<span class="colon">:</span></dt>
<dd class="field-even"><p>If the database is not selected at the class level</p>
</dd>
<dt class="field-odd">raises ConnectionError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the columns cannot be retrieved.</p>
</dd>
</dl>
<p>This example shows a scenario where the database analyst has navigated
into a database</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">change_database</span><span class="p">(</span><span class="s1">&#39;Address&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;CREATE TABLE IF NOT EXIST Names (</span>
<span class="s1">    name_id INTEGER AUTO_INCREMENT,</span>
<span class="s1">    FirstName VARCHAR(20) NOT NULL,</span>
<span class="s1">    MiddleName VARCHAR(20),</span>
<span class="s1">    LastName VARCHAR(20) NOT NULL,</span>
<span class="s1">    PRIMARY KEY (name_id)</span>
<span class="s1">);</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_columns</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span> <span class="n">Field</span>      <span class="n">Type</span>        <span class="n">Null</span>   <span class="n">Key</span>     <span class="n">Default</span>  <span class="n">Extra</span>
   <span class="mi">0</span>     <span class="n">name_id</span>    <span class="n">Integer</span>     <span class="kc">True</span>   <span class="n">Primary</span>  <span class="kc">False</span>   <span class="n">auto_increment</span>
   <span class="mi">1</span>     <span class="n">FirstName</span>  <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">2</span>     <span class="n">MiddleName</span> <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">True</span>   <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">3</span>     <span class="n">LastName</span>   <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
</pre></div>
</div>
</div></blockquote>
<p>However, this code can also be executed when not in the database</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_columns</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">,</span> <span class="s1">&#39;Address&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span> <span class="n">Field</span>      <span class="n">Type</span>        <span class="n">Null</span>   <span class="n">Key</span>     <span class="n">Default</span>  <span class="n">Extra</span>
   <span class="mi">0</span>     <span class="n">name_id</span>    <span class="n">Integer</span>     <span class="kc">True</span>   <span class="n">Primary</span>  <span class="kc">False</span>   <span class="n">auto_increment</span>
   <span class="mi">1</span>     <span class="n">FirstName</span>  <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">2</span>     <span class="n">MiddleName</span> <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">True</span>   <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">3</span>     <span class="n">LastName</span>   <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.pdf_to_table">
<span class="sig-name descname"><span class="pre">pdf_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#MySQLDB.pdf_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.MySQLDB.pdf_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read a table from a PDF file and insert it into the specified MySQL table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> – The path to the PDF file.</p></li>
<li><p><strong>table_name</strong> – The name of the MySQL table.</p></li>
<li><p><strong>pdf_headers</strong> – A dictionary of column names in the PDF and their data
types.</p></li>
<li><p><strong>table_columns</strong> – The names of the columns in the MySQL table
(default is None, assumes PDF column names and MySQL
column names are the same).</p></li>
<li><p><strong>table_idx</strong> – Index of the table in the PDF (default: 0).</p></li>
<li><p><strong>page_num</strong> – Page number from which to extract the table (default: 0).</p></li>
<li><p><strong>skip</strong> – The number of rows to skip in the PDF table.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the PDF file, table name, or sheet name is not
provided, or if the number of PDF headers and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.conn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.MySQLDB.conn" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _conn attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.cur">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cur</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.MySQLDB.cur" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _cur attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.database">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">database</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.MySQLDB.database" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _database attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.MySQLDB.db_engine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db_engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#cobralib.db.MySQLDB.db_engine" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _db_engine attribute</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cobralib.db.</span></span><span class="sig-name descname"><span class="pre">PostGreSQLDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5432</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'localhost'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the database connection to a PostgreSQL server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> – The PostgreSQL username.</p></li>
<li><p><strong>password</strong> – The PostgreSQL password.</p></li>
<li><p><strong>database</strong> – The name of the database to connect to.</p></li>
<li><p><strong>port</strong> – The port number for the PostgreSQL server (default is 5432).</p></li>
<li><p><strong>hostname</strong> – The server’s hostname (default is ‘localhost’).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – If a connection can not be established.</p>
</dd>
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conn</strong> – The connection attribute of the sqlite3 module.</p></li>
<li><p><strong>cur</strong> – The cursor method for the sqlite3 module.</p></li>
<li><p><strong>database</strong> – The name of the database currently being used.</p></li>
<li><p><strong>db_engine</strong> – A string describing the database engine</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.change_database">
<span class="sig-name descname"><span class="pre">change_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.change_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.change_database" title="Permalink to this definition"></a></dt>
<dd><p>Change to a different PostgreSQL database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – The name of the database to switch to.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – If there’s an issue establishing a connection
to the new database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.close_connection">
<span class="sig-name descname"><span class="pre">close_connection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.close_connection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.close_connection" title="Permalink to this definition"></a></dt>
<dd><p>Close the connection to the PostgreSQL server and database.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ConnectionError</strong> – If there’s an issue closing the connection or cursor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.csv_to_table">
<span class="sig-name descname"><span class="pre">csv_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.csv_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.csv_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from a CSV or TXT file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csv_file</strong> – The path to the CSV file or TXT file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>csv_headers</strong> – The names of the columns in the TXT file and datatypes
as a dictionary.</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes CSV column names and table column names
are the same).</p></li>
<li><p><strong>delimiter</strong> – The seperating delimeter in the text file.  Defaulted to
‘,’ for a CSV file, but can work with other delimeters</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition.  Defaulted to 0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the CSV file or table name is not provided, or if
the number of CSV columns and table columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
<p>Assune we have a csv table with the following Columns, <code class="docutils literal notranslate"><span class="pre">FirstName</span></code>,
<code class="docutils literal notranslate"><span class="pre">MiddleName</span></code>, <code class="docutils literal notranslate"><span class="pre">LastName</span></code>.  Within the <code class="docutils literal notranslate"><span class="pre">Names</span></code> database we have
a table with no entries that has columns for <code class="docutils literal notranslate"><span class="pre">First</span></code> and <code class="docutils literal notranslate"><span class="pre">Last</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">PostGreSQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">PostGreSQL</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;Names&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span>
                <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;csv_file.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">])</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
<p>If instead of a csv file, you have a text file that uses spaces as
a delimeter, and the first two rows are consumed by file metadata
before reaching the header, the following code will work</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">PostGreSQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">PostGreSQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;Names&#39;</span><span class="p">,</span>
                   <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;txt_file.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">],</span> <span class="n">delemeter</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
<p>… [rest of the docstring remains unchanged] …</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.excel_to_table">
<span class="sig-name descname"><span class="pre">excel_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excel_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excel_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Sheet1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.excel_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.excel_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from an Excel file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>excel_file</strong> – The path to the Excel file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>excel_headers</strong> – The names of the columns in the Excel file and their
data types as a dictionary</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes Excel column names and table column names are
the same).</p></li>
<li><p><strong>sheet_name</strong> – The name of the sheet in the Excel file
(default is ‘Sheet1’).</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition.  Defaulted to 0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the Excel file, table name, or sheet name is not
provided, or if the number of Excel columns and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
<p>Assune we have an excel table with the following Columns, <code class="docutils literal notranslate"><span class="pre">FirstName</span></code>,
<code class="docutils literal notranslate"><span class="pre">MiddleName</span></code>, <code class="docutils literal notranslate"><span class="pre">LastName</span></code>.  Within the <code class="docutils literal notranslate"><span class="pre">Names</span></code> database we have
a table with no entries that has columns for <code class="docutils literal notranslate"><span class="pre">First</span></code> and <code class="docutils literal notranslate"><span class="pre">Last</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">PostGreSQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">PostGreSQL</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;Names&#39;</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;excel_file.xlsx&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">{</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">},</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">])</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.execute_query">
<span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.execute_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.execute_query" title="Permalink to this definition"></a></dt>
<dd><p>Executes the provided SQL query and returns the results as a pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – The SQL query to execute.</p></li>
<li><p><strong>params</strong> – A tuple of parameters to bind to the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas DataFrame containing the query results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.get_database_tables">
<span class="sig-name descname"><span class="pre">get_database_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.get_database_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.get_database_tables" title="Permalink to this definition"></a></dt>
<dd><p>Fetch a list of tables from the specified or current PostgreSQL database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – The name of the database to fetch tables from. If not
provided, uses the current database.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas DataFrame containing the list of tables with the column
header “Tables”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.get_databases">
<span class="sig-name descname"><span class="pre">get_databases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.get_databases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.get_databases" title="Permalink to this definition"></a></dt>
<dd><p>Fetch a list of databases from the PostgreSQL server.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A pandas DataFrame containing the list of databases with the
column header “Databases”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.get_table_columns">
<span class="sig-name descname"><span class="pre">get_table_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.get_table_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.get_table_columns" title="Permalink to this definition"></a></dt>
<dd><p>Fetch column details for the given table in the specified or current
PostgreSQL database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> – The name of the table to fetch column details for.</p></li>
<li><p><strong>database</strong> – The name of the database the table resides in. If not provided,
uses the current database.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas DataFrame containing column details.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.pdf_to_table">
<span class="sig-name descname"><span class="pre">pdf_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#PostGreSQLDB.pdf_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.PostGreSQLDB.pdf_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read a table from a PDF file and insert it into the specified MySQL table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> – The path to the PDF file.</p></li>
<li><p><strong>table_name</strong> – The name of the MySQL table.</p></li>
<li><p><strong>pdf_headers</strong> – A dictionary of column names in the PDF and their data
types.</p></li>
<li><p><strong>table_columns</strong> – The names of the columns in the MySQL table
(default is None, assumes PDF column names and MySQL
column names are the same).</p></li>
<li><p><strong>table_idx</strong> – Index of the table in the PDF (default: 0).</p></li>
<li><p><strong>page_num</strong> – Page number from which to extract the table (default: 0).</p></li>
<li><p><strong>skip</strong> – The number of rows to skip in the PDF table.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the PDF file, table name, or sheet name is not
provided, or if the number of PDF headers and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.conn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.PostGreSQLDB.conn" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _conn attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.cur">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cur</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.PostGreSQLDB.cur" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _cur attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.database">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">database</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.PostGreSQLDB.database" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _database attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.PostGreSQLDB.db_engine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db_engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#cobralib.db.PostGreSQLDB.db_engine" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _db_engine attribute</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cobralib.db.</span></span><span class="sig-name descname"><span class="pre">SQLiteDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB" title="Permalink to this definition"></a></dt>
<dd><p>A class for connection to a SQLite database file using the sqlite3 python package.
The usser can access the conn and cur variables, where conn is the connection
variable and cur is the connection.cursor() method to expand the capability
of this class beyond its methods.  <strong>NOTE:</strong> If the user passes an incorrect
database name to the constructor, the class will assume that the user wants
to create a database of that name, and will create a new database file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – The name of the database file to include its path length.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – If a connection can not be established.</p>
</dd>
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conn</strong> – The connection attribute of the sqlite3 module.</p></li>
<li><p><strong>cur</strong> – The cursor method for the sqlite3 module.</p></li>
<li><p><strong>database</strong> – The name of the database currently being used.</p></li>
<li><p><strong>db_engine</strong> – A string describing the database engine</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.change_database">
<span class="sig-name descname"><span class="pre">change_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.change_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.change_database" title="Permalink to this definition"></a></dt>
<dd><p>Method to change the connection from one database file to another</p>
<dl class="field-list simple">
<dt class="field-odd">Paramn database<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new database file to be used to include the path length</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.close_connection">
<span class="sig-name descname"><span class="pre">close_connection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.close_connection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.close_connection" title="Permalink to this definition"></a></dt>
<dd><p>Close the connection to tjhe SQLite database</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.csv_to_table">
<span class="sig-name descname"><span class="pre">csv_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.csv_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.csv_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from a CSV or TXT file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csv_file</strong> – The path to the CSV file or TXT file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>csv_headers</strong> – The names of the columns in the TXT file and datatypes
as a dictionary.</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes CSV column names and table column names
are the same).</p></li>
<li><p><strong>delimiter</strong> – The seperating delimeter in the text file.  Defaulted to
‘,’ for a CSV file, but can work with other delimeters</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition.  Defaulted to 0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the CSV file or table name is not provided, or if
the number of CSV columns and table columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.excel_to_table">
<span class="sig-name descname"><span class="pre">excel_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excel_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excel_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Sheet1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.excel_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.excel_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from an Excel file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>excel_file</strong> – The path to the Excel file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>excel_headers</strong> – The names of the columns in the Excel file and their
data types as a dictionary.</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes Excel column names and table column names are
the same).</p></li>
<li><p><strong>sheet_name</strong> – The name of the sheet in the Excel file (default is ‘Sheet1’).</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition. Defaulted to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the Excel file, table name, or sheet name is not
provided, or if the number of Excel columns and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.execute_query">
<span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.execute_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.execute_query" title="Permalink to this definition"></a></dt>
<dd><p>Execute a query with placeholders and return the result as a Pandas DataFrame.
The user of this class should ensure that when applicable they parameteratize
the inputs to this method to minimize the potential for an injection
attack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – The query with placeholders.</p></li>
<li><p><strong>params</strong> – The values to be substituted into the placeholders
(default is an empty tuple).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Pandas DataFrame with the query result.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If the database name is not provided.</p></li>
<li><p><strong>Error</strong> – If the query execution fails.</p></li>
</ul>
</dd>
</dl>
<p>Example usage when parameters are provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mylib.io</span> <span class="kn">import</span> <span class="n">SQLiteDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="s1">&#39;example.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM names WHERE name_id = ?&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span>  <span class="n">FirstName</span>  <span class="n">LastName</span>
   <span class="mi">0</span>      <span class="mi">2</span>        <span class="n">Fred</span>       <span class="n">Smith</span>
</pre></div>
</div>
<p>Example usage when no parameters are provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mylib.io</span> <span class="kn">import</span> <span class="n">SQLiteDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="s1">&#39;example.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM names&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span>  <span class="n">FirstName</span>  <span class="n">LastName</span>
 <span class="mi">0</span>        <span class="mi">1</span>        <span class="n">Jon</span>        <span class="n">Webb</span>
 <span class="mi">1</span>        <span class="mi">2</span>        <span class="n">Fred</span>       <span class="n">Smith</span>
 <span class="mi">2</span>        <span class="mi">3</span>        <span class="n">Jillian</span>    <span class="n">Webb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.get_database_tables">
<span class="sig-name descname"><span class="pre">get_database_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.get_database_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.get_database_tables" title="Permalink to this definition"></a></dt>
<dd><p>Method the retrieve a dataframe containing a list of all tables within
a SQLite database file.  If the user does not pass a database name, the
method will return the list of tables in the current database.  However,
the user can also pass this method the name of another database file,
and this will return a list of tables in that database file/</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – The name of the database or database file that the tables
will be retrieved from.</p>
</dd>
<dt class="field-even">Return df<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe containing all information relating to the tables
within the database or database file.</p>
</dd>
</dl>
<p>Assuming the user has a database titled <code class="docutils literal notranslate"><span class="pre">Inventory</span></code> which had the
tables <code class="docutils literal notranslate"><span class="pre">Names</span></code>, <code class="docutils literal notranslate"><span class="pre">Product</span></code>, <code class="docutils literal notranslate"><span class="pre">Sales</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLiteDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="s1">&#39;test.db&#39;</span><span class="p">)</span>
<span class="n">dbs</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_database_tables</span><span class="p">(</span><span class="s2">&quot;Inventory&quot;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_connection</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dbs</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">Tables</span>
   <span class="mi">0</span>      <span class="n">Names</span>
   <span class="mi">1</span>      <span class="n">Product</span>
   <span class="mi">2</span>      <span class="n">Sales</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.get_databases">
<span class="sig-name descname"><span class="pre">get_databases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.get_databases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.get_databases" title="Permalink to this definition"></a></dt>
<dd><p>Method included for compatibility with RelationalDB Protocol class. This method
returns an empty dataframe since SQLite does not support true databases.</p>
<p>:return : An empty pandas dataframe</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.get_table_columns">
<span class="sig-name descname"><span class="pre">get_table_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.get_table_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.get_table_columns" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Retrieve the names and data types of the columns within the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">param table_name<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the table.</p>
</dd>
<dt class="field-even">param database<span class="colon">:</span></dt>
<dd class="field-even"><p>The database name, defaulted to currently selected database
or None</p>
</dd>
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>A pandas dataframe with headers ot Field, Type, Null, Key, Default,
and Extra</p>
</dd>
<dt class="field-even">raises ValueError<span class="colon">:</span></dt>
<dd class="field-even"><p>If the database is not selected at the class level</p>
</dd>
<dt class="field-odd">raises ConnectionError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the columns cannot be retrieved.</p>
</dd>
</dl>
<p>This example shows a scenario where the database analyst has navigated
into a database</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLiteDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLiteDB</span><span class="p">(</span><span class="s1">&#39;test_db.db&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;CREATE TABLE IF NOT EXIST Names (</span>
<span class="s1">    name_id INTEGER AUTO_INCREMENT,</span>
<span class="s1">    FirstName VARCHAR(20) NOT NULL,</span>
<span class="s1">    MiddleName VARCHAR(20),</span>
<span class="s1">    LastName VARCHAR(20) NOT NULL,</span>
<span class="s1">    PRIMARY KEY (name_id)</span>
<span class="s1">);</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_columns</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span> <span class="n">Field</span>      <span class="n">Type</span>        <span class="n">Null</span>   <span class="n">Key</span>     <span class="n">Default</span>  <span class="n">Extra</span>
   <span class="mi">0</span>     <span class="n">name_id</span>    <span class="n">Integer</span>     <span class="kc">True</span>   <span class="n">Primary</span>  <span class="kc">False</span>   <span class="n">autoincrement</span>
   <span class="mi">1</span>     <span class="n">FirstName</span>  <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">2</span>     <span class="n">MiddleName</span> <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">True</span>   <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">3</span>     <span class="n">LastName</span>   <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
</pre></div>
</div>
</div></blockquote>
<p>However, this code can also be executed when not in the database</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">MySQLDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">MySQLDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_columns</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">,</span> <span class="s1">&#39;Address&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span> <span class="n">Field</span>      <span class="n">Type</span>        <span class="n">Null</span>   <span class="n">Key</span>     <span class="n">Default</span>  <span class="n">Extra</span>
   <span class="mi">0</span>     <span class="n">name_id</span>    <span class="n">Integer</span>     <span class="kc">True</span>   <span class="n">Primary</span>  <span class="kc">False</span>   <span class="n">autoincrement</span>
   <span class="mi">1</span>     <span class="n">FirstName</span>  <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">2</span>     <span class="n">MiddleName</span> <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">True</span>   <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">3</span>     <span class="n">LastName</span>   <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.pdf_to_table">
<span class="sig-name descname"><span class="pre">pdf_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLiteDB.pdf_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLiteDB.pdf_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read a table from a PDF file and insert it into the specified SQLite table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> – The path to the PDF file.</p></li>
<li><p><strong>table_name</strong> – The name of the SQLite table.</p></li>
<li><p><strong>pdf_headers</strong> – A dictionary of column names in the PDF and their data
types.</p></li>
<li><p><strong>table_columns</strong> – The names of the columns in the SQLite table
(default is None, assumes PDF column names and SQLite
column names are the same).</p></li>
<li><p><strong>table_idx</strong> – Index of the table in the PDF (default: 0).</p></li>
<li><p><strong>page_num</strong> – Page number from which to extract the table (default: 0).</p></li>
<li><p><strong>skip</strong> – The number of rows to skip in the PDF table.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the PDF file, table name, or sheet name is not
provided, or if the number of PDF headers and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.conn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.SQLiteDB.conn" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _conn attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.cur">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cur</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.SQLiteDB.cur" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _cur attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.database">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">database</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.SQLiteDB.database" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _database attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.SQLiteDB.db_engine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db_engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#cobralib.db.SQLiteDB.db_engine" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _db_engine attribute</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cobralib.db.</span></span><span class="sig-name descname"><span class="pre">SQLServerDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1433</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cert</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'yes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'{ODBC</span> <span class="pre">Driver</span> <span class="pre">18</span> <span class="pre">for</span> <span class="pre">SQL</span> <span class="pre">Server}'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the SQLServerDB object with connection parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> – The username to connect to the database.</p></li>
<li><p><strong>password</strong> – The password to connect to the database.</p></li>
<li><p><strong>port</strong> – The port number to use for the connection. Default is 1433.</p></li>
<li><p><strong>hostname</strong> – The database server name or IP address. Default is
‘localhost’.</p></li>
<li><p><strong>database</strong> – The initial database to connect to (can be changed later).</p></li>
<li><p><strong>cert</strong> – yes to trust certificat and no to not trust certificate
without authentication. Defaulted to yes</p></li>
<li><p><strong>driver</strong> – The ODBC driver to use for connection. Defaulted to
“{ODBC Driver 18 for SQL Server}”</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – If a connection can not be established.</p>
</dd>
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conn</strong> – The connection attribute of the sqlite3 module.</p></li>
<li><p><strong>cur</strong> – The cursor method for the sqlite3 module.</p></li>
<li><p><strong>database</strong> – The name of the database currently being used.</p></li>
<li><p><strong>db_engine</strong> – A string describing the database engine</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.change_database">
<span class="sig-name descname"><span class="pre">change_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.change_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.change_database" title="Permalink to this definition"></a></dt>
<dd><p>Change the active database for the current connection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – The name of the database to switch to.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – if query fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.close_connection">
<span class="sig-name descname"><span class="pre">close_connection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.close_connection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.close_connection" title="Permalink to this definition"></a></dt>
<dd><p>Close the database connection.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.csv_to_table">
<span class="sig-name descname"><span class="pre">csv_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.csv_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.csv_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from a CSV or TXT file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csv_file</strong> – The path to the CSV file or TXT file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>csv_headers</strong> – The names of the columns in the TXT file and datatypes
as a dictionary.</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes CSV column names and table column names
are the same).</p></li>
<li><p><strong>delimiter</strong> – The seperating delimeter in the text file.  Defaulted to
‘,’ for a CSV file, but can work with other delimeters</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition.  Defaulted to 0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the CSV file or table name is not provided, or if
the number of CSV columns and table columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
<p>Assune we have a csv table with the following Columns, <code class="docutils literal notranslate"><span class="pre">FirstName</span></code>,
<code class="docutils literal notranslate"><span class="pre">MiddleName</span></code>, <code class="docutils literal notranslate"><span class="pre">LastName</span></code>.  Within the <code class="docutils literal notranslate"><span class="pre">Names</span></code> database we have
a table with no entries that has columns for <code class="docutils literal notranslate"><span class="pre">First</span></code> and <code class="docutils literal notranslate"><span class="pre">Last</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">change_db</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;csv_file.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">])</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
<p>If instead of a csv file, you have a text file that uses spaces as
a delimeter, and the first two rows are consumed by file metadata
before reaching the header, the following code will work</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">change_db</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;txt_file.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">],</span> <span class="n">delemeter</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.excel_to_table">
<span class="sig-name descname"><span class="pre">excel_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excel_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excel_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Sheet1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.excel_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.excel_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read data from an Excel file and insert it into the specified table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>excel_file</strong> – The path to the Excel file.</p></li>
<li><p><strong>table_name</strong> – The name of the table.</p></li>
<li><p><strong>excel_headers</strong> – The names of the columns in the Excel file and their
data types as a dictionary</p></li>
<li><p><strong>table_headers</strong> – The names of the columns in the table (default is None,
assumes Excel column names and table column names are
the same).</p></li>
<li><p><strong>sheet_name</strong> – The name of the sheet in the Excel file
(default is ‘Sheet1’).</p></li>
<li><p><strong>skip</strong> – The number of rows to be skipped if metadata exists before
the header definition.  Defaulted to 0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the Excel file, table name, or sheet name is not
provided, or if the number of Excel columns and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
<p>Assune we have an excel table with the following Columns, <code class="docutils literal notranslate"><span class="pre">FirstName</span></code>,
<code class="docutils literal notranslate"><span class="pre">MiddleName</span></code>, <code class="docutils literal notranslate"><span class="pre">LastName</span></code>.  Within the <code class="docutils literal notranslate"><span class="pre">Names</span></code> database we have
a table with no entries that has columns for <code class="docutils literal notranslate"><span class="pre">First</span></code> and <code class="docutils literal notranslate"><span class="pre">Last</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">change_db</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">csv_to_table</span><span class="p">(</span><span class="s1">&#39;excel_file.xlsx&#39;</span><span class="p">,</span> <span class="s1">&#39;FirstLastName&#39;</span><span class="p">,</span>
                <span class="p">{</span><span class="s1">&#39;FirstName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;LastName&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">},</span>
                <span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">,</span> <span class="s1">&#39;Last&#39;</span><span class="p">])</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELDCT * FROM Names;&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query_db</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span> <span class="n">First</span>   <span class="n">Last</span>
   <span class="mi">0</span>      <span class="mi">1</span>       <span class="n">Jon</span>     <span class="n">Webb</span>
   <span class="mi">1</span>      <span class="mi">2</span>       <span class="n">Fred</span>    <span class="n">Smith</span>
   <span class="mi">2</span>      <span class="mi">3</span>       <span class="n">Jillian</span> <span class="n">Webb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.execute_query">
<span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.execute_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.execute_query" title="Permalink to this definition"></a></dt>
<dd><p>Execute a given query on the SQL Server database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – The SQL query string to execute.</p></li>
<li><p><strong>params</strong> – Optional tuple containing parameters for the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the query results if any, otherwise an empty
DataFrame.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If the database name is not provided.</p></li>
<li><p><strong>ConnectionError</strong> – If the query execution fails.</p></li>
</ul>
</dd>
</dl>
<p>Example usage when parameters are provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM names WHERE name_id = </span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span>  <span class="n">FirstName</span>  <span class="n">LastName</span>
   <span class="mi">0</span>      <span class="mi">2</span>        <span class="n">Fred</span>       <span class="n">Smith</span>
</pre></div>
</div>
<p>Example usage when no parameters are provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM names&quot;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">name_id</span>  <span class="n">FirstName</span>  <span class="n">LastName</span>
 <span class="mi">0</span>        <span class="mi">1</span>        <span class="n">Jon</span>        <span class="n">Webb</span>
 <span class="mi">1</span>        <span class="mi">2</span>        <span class="n">Fred</span>       <span class="n">Smith</span>
 <span class="mi">2</span>        <span class="mi">3</span>        <span class="n">Jillian</span>    <span class="n">Webb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.get_database_tables">
<span class="sig-name descname"><span class="pre">get_database_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.get_database_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.get_database_tables" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve a list of tables from the given or current SQL Server database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>database</strong> – Optional name of the database to fetch tables from.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the table names.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If no database is currently selected.</p></li>
<li><p><strong>ConnectionError</strong> – If program is not able to get tables</p></li>
</ul>
</dd>
</dl>
<p>Assuming the user has a database titled <code class="docutils literal notranslate"><span class="pre">Inventory</span></code> which had the
tables <code class="docutils literal notranslate"><span class="pre">Names</span></code>, <code class="docutils literal notranslate"><span class="pre">Product</span></code>, <code class="docutils literal notranslate"><span class="pre">Sales</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">dbs</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_database_tables</span><span class="p">(</span><span class="s2">&quot;Inventory&quot;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dbs</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">Tables</span>
   <span class="mi">0</span>      <span class="n">Names</span>
   <span class="mi">1</span>      <span class="n">Product</span>
   <span class="mi">2</span>      <span class="n">Sales</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.get_databases">
<span class="sig-name descname"><span class="pre">get_databases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.get_databases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.get_databases" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve a list of databases from the SQL Server.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame containing the database names.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConnectionError</strong> – If program fails to retrive database</p>
</dd>
</dl>
<p>If you assume the server has three databases available to the username, and
those databases were <code class="docutils literal notranslate"><span class="pre">Inventory</span></code>, <code class="docutils literal notranslate"><span class="pre">Address</span></code>, <code class="docutils literal notranslate"><span class="pre">project_data</span></code>, you
could use this class with the following commands.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">dbs</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_databases</span><span class="p">()</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dbs</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span>  <span class="n">Databases</span>
   <span class="mi">0</span>      <span class="n">Address</span>
   <span class="mi">1</span>      <span class="n">Inventory</span>
   <span class="mi">2</span>      <span class="n">project_data</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.get_table_columns">
<span class="sig-name descname"><span class="pre">get_table_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.get_table_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.get_table_columns" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve column details of the specified table from the given or current SQL
Server database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> – Name of the table to fetch column details from.</p></li>
<li><p><strong>database</strong> – Optional name of the database the table is in.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the column details.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – <p>If the database is not selected at the class level
:raises ConnectionError: If the columns cannot be retrieved.</p>
<p>This example shows a scenario where the database analyst has navigated
into a database</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">change_database</span><span class="p">(</span><span class="s1">&#39;Address&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;CREATE TABLE IF NOT EXIST Names (</span>
<span class="s1">    name_id INTEGER AUTO_INCREMENT,</span>
<span class="s1">    FirstName VARCHAR(20) NOT NULL,</span>
<span class="s1">    MiddleName VARCHAR(20),</span>
<span class="s1">    LastName VARCHAR(20) NOT NULL,</span>
<span class="s1">    PRIMARY KEY (name_id)</span>
<span class="s1">);</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">db</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_columns</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span> <span class="n">Field</span>      <span class="n">Type</span>        <span class="n">Null</span>   <span class="n">Key</span>     <span class="n">Default</span>  <span class="n">Extra</span>
   <span class="mi">0</span>     <span class="n">name_id</span>    <span class="n">Integer</span>     <span class="kc">True</span>   <span class="n">Primary</span>  <span class="kc">False</span>   <span class="n">auto_increment</span>
   <span class="mi">1</span>     <span class="n">FirstName</span>  <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">2</span>     <span class="n">MiddleName</span> <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">True</span>   <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
   <span class="mi">3</span>     <span class="n">LastName</span>   <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<p>However, this code can also be executed when not in the database</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cobralib.io</span> <span class="kn">import</span> <span class="n">SQLServerDB</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLServerDB</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_table_columns</span><span class="p">(</span><span class="s1">&#39;Names&#39;</span><span class="p">,</span> <span class="s1">&#39;Address&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">close_conn</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">index</span> <span class="n">Field</span>      <span class="n">Type</span>        <span class="n">Null</span>   <span class="n">Key</span>     <span class="n">Default</span>  <span class="n">Extra</span>
    <span class="mi">0</span>     <span class="n">name_id</span>    <span class="n">Integer</span>     <span class="kc">True</span>   <span class="n">Primary</span>  <span class="kc">False</span>   <span class="n">auto_increment</span>
    <span class="mi">1</span>     <span class="n">FirstName</span>  <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
    <span class="mi">2</span>     <span class="n">MiddleName</span> <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">True</span>   <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
    <span class="mi">3</span>     <span class="n">LastName</span>   <span class="n">Varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kc">False</span>  <span class="n">NA</span>       <span class="kc">False</span>   <span class="kc">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.pdf_to_table">
<span class="sig-name descname"><span class="pre">pdf_to_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_headers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">type</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cobralib/db.html#SQLServerDB.pdf_to_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cobralib.db.SQLServerDB.pdf_to_table" title="Permalink to this definition"></a></dt>
<dd><p>Read a table from a PDF file and insert it into the specified MySQL table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> – The path to the PDF file.</p></li>
<li><p><strong>table_name</strong> – The name of the MySQL table.</p></li>
<li><p><strong>pdf_headers</strong> – A dictionary of column names in the PDF and their data
types.</p></li>
<li><p><strong>table_columns</strong> – The names of the columns in the MySQL table
(default is None, assumes PDF column names and MySQL
column names are the same).</p></li>
<li><p><strong>table_idx</strong> – Index of the table in the PDF (default: 0).</p></li>
<li><p><strong>page_num</strong> – Page number from which to extract the table (default: 0).</p></li>
<li><p><strong>skip</strong> – The number of rows to skip in the PDF table.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the PDF file, table name, or sheet name is not
provided, or if the number of PDF headers and table
columns mismatch.</p></li>
<li><p><strong>Error</strong> – If the data insertion fails or the data types are
incompatible.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.conn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.SQLServerDB.conn" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _conn attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.cur">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cur</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.SQLServerDB.cur" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _cur attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.database">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">database</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#cobralib.db.SQLServerDB.database" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _database attribute</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cobralib.db.SQLServerDB.db_engine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db_engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#cobralib.db.SQLServerDB.db_engine" title="Permalink to this definition"></a></dt>
<dd><p>Protection for the _db_engine attribute</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="io.html" class="btn btn-neutral float-left" title="Input / Output (io)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Jonathan A. Webb.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
